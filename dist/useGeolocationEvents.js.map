{"version":3,"sources":["useGeolocationEvents.js"],"names":["useGeolocationEvents","options","geolocationStandardOptions","watchId","onChangeRef","setOnChangeRef","onErrorRef","setOnErrorRef","isSupported","window","navigator","onSuccess","current","onError","geolocation","watchPosition","clearWatch","Object","freeze","onChange"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;;;;;;;;;AA8BA,IAAMA,oBAAoB,GAAG,SAAvBA,oBAAuB,GAA0C;AAAA,MAAzCC,OAAyC,uEAA/BC,sCAA+B;AACrE,MAAMC,OAAO,GAAG,oBAAhB;;AADqE,wBAE/B,kCAF+B;AAAA;AAAA,MAE9DC,WAF8D;AAAA,MAEjDC,cAFiD;;AAAA,yBAGjC,kCAHiC;AAAA;AAAA,MAG9DC,UAH8D;AAAA,MAGlDC,aAHkD;;AAIrE,MAAMC,WAAW,GAAG,oBAAQ;AAAA,WAAO,iBAAiBC,MAAM,CAACC,SAA/B;AAAA,GAAR,EAAmD,CAACN,WAAD,EAAcE,UAAd,CAAnD,CAApB;AAEA,wBAAU,YAAM;AACd,QAAMK,SAAS,GAAG,SAAZA,SAAY,GAAa;AAC7B,UAAIP,WAAW,CAACQ,OAAhB,EAAyB;AACvBR,QAAAA,WAAW,CAACQ,OAAZ,OAAAR,WAAW,YAAX;AACD;AACF,KAJD;;AAKA,QAAMS,OAAO,GAAG,SAAVA,OAAU,GAAa;AAC3B,UAAIP,UAAU,CAACM,OAAf,EAAwB;AACtBN,QAAAA,UAAU,CAACM,OAAX,OAAAN,UAAU,YAAV;AACD;AACF,KAJD;;AAMA,QAAIE,WAAJ,EAAiB;AACfL,MAAAA,OAAO,CAACS,OAAR,GAAkBH,MAAM,CAACC,SAAP,CAAiBI,WAAjB,CAA6BC,aAA7B,CAA2CJ,SAA3C,EAAsDE,OAAtD,EAA+DZ,OAA/D,CAAlB;AACD;;AAED,WAAO,YAAM;AACX,UAAIO,WAAJ,EAAiB;AACfC,QAAAA,MAAM,CAACC,SAAP,CAAiBI,WAAjB,CAA6BE,UAA7B,CAAwCb,OAAO,CAACS,OAAhD;AACD;AACF,KAJD;AAKD,GArBD,EAqBG,CAACR,WAAD,EAAcE,UAAd,CArBH;AAuBA,SAAO,CAACE,WAAD,GAAe,0CAAyB,sCAAzB,CAAf,GAAkFS,MAAM,CAACC,MAAP,CAAc;AACrGV,IAAAA,WAAW,EAAXA,WADqG;AAErGW,IAAAA,QAAQ,EAAEd,cAF2F;AAGrGQ,IAAAA,OAAO,EAAEN;AAH4F,GAAd,CAAzF;AAKD,CAlCD;;eAoCeP,oB","sourcesContent":["import { useEffect, useMemo, useRef } from 'react';\nimport useCallbackRef from './useCallbackRef';\nimport createCbSetterErrorProxy from './utils/createCbSetterErrorProxy';\nimport geolocationStandardOptions from './utils/geolocationStandardOptions';\n\n/**\n * Returns a frozen object of callback setters to handle the geolocation events.<br/>\n * So far, the supported methods are: `onChange`, invoked when the position changes and `onError`, invoked when\n * an error occur while retrieving the position.<br/>\n * The returned object also contains the `isSupported` boolean flag reporting whether the geolocation API is supported.\n *\n * ### Usage:\n *\n * ```jsx harmony\n * const GeoReporter = () => {\n *   const [ position, setGeoPosition] = useState();\n *   const [ error, setError] = useState();\n *   const { isSupported, onChange, onError } = useGeolocationEvents({ enableHighAccuracy: true });\n *\n *   onChange((geoPosition) => setGeoPosition(geoPosition));\n *   onError((err) => setError(err));\n *\n *   return (\n *    <div>\n *      <p>Geolocation supported: {isSupported ? 'yes' : 'no'}</p>\n *      {!error && position && (\n *        <p>lat: {position.coords.latitude}, lng: {position.coords.longitude}</p>\n *      )}\n *    </div>\n *   );\n * };\n * ```\n */\nconst useGeolocationEvents = (options = geolocationStandardOptions) => {\n  const watchId = useRef();\n  const [onChangeRef, setOnChangeRef] = useCallbackRef();\n  const [onErrorRef, setOnErrorRef] = useCallbackRef();\n  const isSupported = useMemo(() => ('geolocation' in window.navigator), [onChangeRef, onErrorRef]);\n\n  useEffect(() => {\n    const onSuccess = (...args) => {\n      if (onChangeRef.current) {\n        onChangeRef.current(...args);\n      }\n    };\n    const onError = (...args) => {\n      if (onErrorRef.current) {\n        onErrorRef.current(...args);\n      }\n    };\n\n    if (isSupported) {\n      watchId.current = window.navigator.geolocation.watchPosition(onSuccess, onError, options);\n    }\n\n    return () => {\n      if (isSupported) {\n        window.navigator.geolocation.clearWatch(watchId.current);\n      }\n    };\n  }, [onChangeRef, onErrorRef]);\n\n  return !isSupported ? createCbSetterErrorProxy('The Geolocation API is not supported') : Object.freeze({\n    isSupported,\n    onChange: setOnChangeRef,\n    onError: setOnErrorRef,\n  });\n};\n\nexport default useGeolocationEvents;\n"],"file":"useGeolocationEvents.js"}